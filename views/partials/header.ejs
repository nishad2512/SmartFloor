<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>SmartFloor - Premium Flooring</title>
        <link rel="icon" type="image/png" href="/images/favicon.png" />

        <script src="https://cdn.tailwindcss.com"></script>
        <script src="https://unpkg.com/@phosphor-icons/web"></script>
        <link
            href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap"
            rel="stylesheet"
        />
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

        <script>
            tailwind.config = {
                theme: {
                    extend: {
                        fontFamily: {
                            sans: ['"Plus Jakarta Sans"', "sans-serif"],
                        },
                        screens: {
                            "3xl": "1800px",
                        },
                        fontSize: {
                            huge: "5rem",
                        },
                    },
                },
            };
        </script>

        <style>
            html {
                scroll-behavior: smooth;
            }
            body {
                -webkit-font-smoothing: antialiased;
            }
        </style>
    </head>

    <body class="bg-white text-[#1A1A1A]">
        <%- include('../partials/flash') %>

        <div class="w-full max-w-[1680px] mx-auto px-6 2xl:px-0">
            <nav class="flex justify-between items-center py-8">
                <div class="flex items-center gap-3">
                    <div
                        class="bg-black text-white w-10 h-10 rounded-full flex items-center justify-center"
                    >
                        <i class="ph-bold ph-diamond text-lg"></i>
                    </div>
                    <span class="font-extrabold text-2xl tracking-tight"
                        >SmartFloor</span
                    >
                </div>

                <ul
                    class="hidden md:flex gap-20 text-base font-medium text-gray-500"
                >
                    <li class="hover:text-black cursor-pointer transition">
                        <a href="/">Home</a>
                    </li>
                    <li class="hover:text-black cursor-pointer transition">
                        <a href="/products">Products</a>
                    </li>
                    <li class="hover:text-black cursor-pointer transition">
                        <a href="/about">About Us</a>
                    </li>
                    <li class="hover:text-black cursor-pointer transition">
                        <a href="/contact">Contact</a>
                    </li>
                </ul>

                <div class="flex items-center gap-8">
                    <form action="/products<%= locals.category ? '/' + locals.category : '' %>" method="GET" class="relative">
                    <div
                        class="flex items-center bg-[#F5F5F5] hover:bg-[#EAEAEA] focus-within:bg-white focus-within:ring-1 focus-within:ring-black rounded-full transition-colors"
                    >
                        <div class="pl-3 text-gray-400">
                            <i class="ph-bold ph-magnifying-glass text-xl"></i>
                        </div>

                        <input
                            type="text"
                            name="search"
                            value="<%= typeof search !== 'undefined' ? search : '' %>"
                            id="searchInput"
                            placeholder="Search products..."
                            class="bg-transparent border-none outline-none text-sm w-56 px-3 py-2.5 text-[#1A1A1A] placeholder:text-gray-400"
                            autocomplete="off"
                        />

                        <a 
                            href="/products<%= locals.category ? '/' + locals.category : '' %>" 
                            id="clearBtn" 
                            class="pr-3 text-gray-400 hover:text-black"
                        >
                            <i class="ph-bold ph-x text-lg"></i>
                        </a>
                    </div>

                    <% if (locals.query?.sort) { %>
                        <input type="hidden" name="sort" value="<%= locals.query.sort %>">
                    <% } %>

                    <% if (locals.query?.minPrice) { %>
                        <input type="hidden" name="minPrice" value="<%= locals.query.minPrice %>">
                    <% } %>

                    <% if (locals.query?.maxPrice) { %>
                        <input type="hidden" name="maxPrice" value="<%= locals.query.maxPrice %>">
                    <% } %>

                    <!-- Reset pagination -->
                    <input type="hidden" name="page" value="1">
                </form>

                <% if (!locals.user) { %>
                <a href="/login">
                    <button
                        class="bg-[#F0F0F0] hover:bg-[#E0E0E0] text-black px-10 py-3 rounded-full font-bold text-sm transition"
                    >
                        Login
                    </button>
                </a>
                <% } else { %>

                <div class="flex items-center gap-8">
                    <button class="text-black hover:opacity-70 transition">
                        <i class="ph-bold ph-heart text-2xl"></i>
                    </button>

                    <a href="/profile/details" id="userButton" class="text-black hover:opacity-70 transition">
                        <i class="ph-bold ph-user text-2xl"></i>
                    </a>

                    <button class="text-black hover:opacity-70 transition">
                        <i class="ph-bold ph-shopping-bag text-2xl"></i>
                    </button>
                <% } %>
                </div>
            </nav>
            <%- include('flash.ejs') %>

            <script>
                const searchInput = document.getElementById("searchInput");
                const clearBtn = document.getElementById("clearBtn");
                const navLinks = document.querySelectorAll("nav ul li a");
                const currentPath = window.location.pathname;

                navLinks.forEach((link) => {
                    if (link.getAttribute("href") === currentPath) {
                        link.classList.add("text-black", "font-bold");
                    }
                });
            </script>