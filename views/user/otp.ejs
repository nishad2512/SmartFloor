<!DOCTYPE html>

<html class="light" lang="en">
    <head>
        <meta charset="utf-8" />
        <meta content="width=device-width, initial-scale=1.0" name="viewport" />
        <title>OTP Verification</title>
        <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
        <link
            href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@400;500;600;700;900&amp;display=swap"
            rel="stylesheet"
        />
        <link
            href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined"
            rel="stylesheet"
        />
        <script>
            tailwind.config = {
                darkMode: "class",
                theme: {
                    extend: {
                        colors: {
                            primary: "#136dec",
                            "background-light": "#f8f9fa",
                            "background-dark": "#101822",
                        },
                        fontFamily: {
                            display: ["Work Sans", "sans-serif"],
                        },
                        borderRadius: {
                            DEFAULT: "0.25rem",
                            lg: "0.5rem",
                            xl: "0.75rem",
                            full: "9999px",
                        },
                    },
                },
            };
        </script>
        <style>
            /* Hide number input spinners */
            input[type="number"]::-webkit-inner-spin-button,
            input[type="number"]::-webkit-outer-spin-button {
                -webkit-appearance: none;
                margin: 0;
            }
            input[type="number"] {
                -moz-appearance: textfield;
            }
        </style>
    </head>
    <body class="font-display bg-background-light dark:bg-background-dark">
        <div
            class="relative flex min-h-screen w-full flex-col items-center justify-center p-4"
        >
            <div class="w-full max-w-md space-y-8 px-4 py-8">
                <!-- PageHeading -->
                <div class="text-center">
                    <h1
                        class="text-3xl font-black text-[#111418] dark:text-white tracking-tight md:text-4xl"
                    >
                        Check your email
                    </h1>
                    <p class="mt-3 text-[#6C757D] dark:text-gray-400">
                        We've sent a 6-digit code to <%= email %>
                    </p>
                </div>
                <% if (locals.err) { %>
                <p class="text-red-700"><%= err %></p>
                <% } %>
                <!-- ConfirmationCode -->
                <form action="/otp" method="post">
                    <div class="flex justify-center">
                        <fieldset class="flex gap-2 sm:gap-4">
                            <input
                                class="flex h-14 w-12 sm:w-14 text-center text-xl font-bold [appearance:textfield] border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-black dark:text-white focus:outline-none focus:ring-2 focus:ring-black dark:focus:ring-primary [&amp;::-webkit-inner-spin-button]:appearance-none [&amp;::-webkit-outer-spin-button]:appearance-none"
                                maxlength="1"
                                oninput="this.value=this.value.slice(0,1)"
                                onkeyup="if(this.value.length === 1) this.nextElementSibling?.focus()"
                                type="number"
                                name="digit1"
                            />
                            <input
                                class="flex h-14 w-12 sm:w-14 text-center text-xl font-bold [appearance:textfield] border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-black dark:text-white focus:outline-none focus:ring-2 focus:ring-black dark:focus:ring-primary [&amp;::-webkit-inner-spin-button]:appearance-none [&amp;::-webkit-outer-spin-button]:appearance-none"
                                maxlength="1"
                                oninput="this.value=this.value.slice(0,1)"
                                onkeyup="if(this.value.length === 1) this.nextElementSibling?.focus()"
                                type="number"
                                name="digit2"
                            />
                            <input
                                class="flex h-14 w-12 sm:w-14 text-center text-xl font-bold [appearance:textfield] border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-black dark:text-white focus:outline-none focus:ring-2 focus:ring-black dark:focus:ring-primary [&amp;::-webkit-inner-spin-button]:appearance-none [&amp;::-webkit-outer-spin-button]:appearance-none"
                                maxlength="1"
                                oninput="this.value=this.value.slice(0,1)"
                                onkeyup="if(this.value.length === 1) this.nextElementSibling?.focus()"
                                type="number"
                                name="digit3"
                            />
                            <input
                                class="flex h-14 w-12 sm:w-14 text-center text-xl font-bold [appearance:textfield] border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-black dark:text-white focus:outline-none focus:ring-2 focus:ring-black dark:focus:ring-primary [&amp;::-webkit-inner-spin-button]:appearance-none [&amp;::-webkit-outer-spin-button]:appearance-none"
                                maxlength="1"
                                oninput="this.value=this.value.slice(0,1)"
                                onkeyup="if(this.value.length === 1) this.nextElementSibling?.focus()"
                                type="number"
                                name="digit4"
                            />
                            <input
                                class="flex h-14 w-12 sm:w-14 text-center text-xl font-bold [appearance:textfield] border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-black dark:text-white focus:outline-none focus:ring-2 focus:ring-black dark:focus:ring-primary [&amp;::-webkit-inner-spin-button]:appearance-none [&amp;::-webkit-outer-spin-button]:appearance-none"
                                maxlength="1"
                                oninput="this.value=this.value.slice(0,1)"
                                onkeyup="if(this.value.length === 1) this.nextElementSibling?.focus()"
                                type="number"
                                name="digit5"
                            />
                            <input
                                class="flex h-14 w-12 sm:w-14 text-center text-xl font-bold [appearance:textfield] border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-black dark:text-white focus:outline-none focus:ring-2 focus:ring-black dark:focus:ring-primary [&amp;::-webkit-inner-spin-button]:appearance-none [&amp;::-webkit-outer-spin-button]:appearance-none"
                                maxlength="1"
                                oninput="this.value=this.value.slice(0,1)"
                                type="number"
                                name="digit6"
                            />
                        </fieldset>
                    </div>
                    <!-- SingleButton -->
                    <div class="pt-4">
                        <button
                            type="submit"
                            class="flex w-full cursor-pointer items-center justify-center overflow-hidden rounded-lg h-12 px-5 bg-black text-white text-base font-bold leading-normal tracking-[0.015em] transition-opacity hover:opacity-90 disabled:cursor-not-allowed disabled:opacity-50"
                        >
                            <span class="truncate">Verify Account</span>
                        </button>
                    </div>
                </form>
                <!-- MetaText -->
                <div class="text-center disabled">
                    <p class="text-[#6C757D] dark:text-gray-400 text-sm">
                        You can resend OTP in
                        <span
                            id="countdown"
                            class="font-medium text-black dark:text-white"
                            >60</span
                        >
                    </p>
                </div>
                <div class="text-center disabled">
                    <p class="text-[#6C757D] dark:text-gray-400 text-sm">
                        Didn't receive a code?
                        <a
                            class="font-medium text-black dark:text-white hover:underline"
                            id="resend"
                            href="/resend"
                            >Resend</a
                        >
                    </p>
                </div>
            </div>
        </div>
        <script>
            let Expiry = Number("<%= expiry %>");
            let timeleft = Math.floor((Expiry - Date.now()) / 1000);
            let countdown = document.getElementById("countdown");
            let resend = document.getElementById("resend");

            countdown.textContent = timeleft;
            resend.classList.add("pointer-events-none");

            function startTimer() {
                // clearInterval(timer);

                timer = setInterval(() => {
                    timeleft--;
                    countdown.textContent = timeleft;
                    console.log(timeleft);
                    if (timeleft <= 0) {
                        clearInterval(timer);
                        countdown.textContent = 0;
                        resend.classList.remove("pointer-events-none");
                    }
                }, 1000);
            }
            startTimer();

            resend.addEventListener("click", () => {
                let Expiry = Number("<%= expiry %>");
                let timeleft = Math.floor((Expiry - Date.now()) / 1000);
                countdown.textContent = timeleft;
                resend.classList.add("pointer-events-none");
                starTimer();
            });
        </script>
    </body>
</html>
